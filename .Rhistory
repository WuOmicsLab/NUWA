library("devtools")
df <- data.frame(x=rep(1:2,5), rnorm(10))
df
df <- data.frame(x=rep(1:2,5), y=rnorm(10))
boxplot(y~x,df)
boxplot(y~x,df, ylab = "fdsagf")
y=c(1,3,5,6,9, 33);
x=c(2,5,8,10,12,22);
lm(y~x)
x=c(1,3,5,6,9, 33);
y=c(2,5,8,10,12,22);
lm(y~x)
6.4709*0.57336
round(6.4709*0.57336,10)
getwd()
matrix(0,6,6)
matrix(0,6,6)->a
trace(a)
tls <- list(a=random.mat(100,100), b=random.mat(80,30)
tls <- list(a=random.mat(100,100), b=random.mat(80,30),
c= random.mat(160, 40), d=random.mat(400,10),e=random.mat(60,10))
res <- buildNetwork(tls, markers = paste0("row", 1:10), ncores = 5)
# test------------------------------
tls <- list(a=random.mat(100,100), b=random.mat(80,30),
c= random.mat(160, 40), d=random.mat(400,10),e=random.mat(60,10))
source('D:/Users/xiergo/Desktop/Rpackage/NUWA/R/buildNetwork.R', echo=TRUE)
load("data/6trs.rda")
load("data/markers.rda")
load("data/mydata.rda")
tls <- list(a=random.mat(100,100), b=random.mat(80,30),
c= random.mat(160, 40), d=random.mat(400,10),e=random.mat(60,10))
res <- buildNetwork(tls, markers = paste0("row", 1:10), ncores = 5)
source('D:/Users/xiergo/Desktop/Rpackage/NUWA/R/buildNetwork.R', echo=TRUE)
source('D:/Users/xiergo/Desktop/Rpackage/NUWA/R/myfun.R', echo=TRUE)
source('D:/Users/xiergo/Desktop/Rpackage/NUWA/R/buildNetwork.R', echo=TRUE)
source('D:/Users/xiergo/Desktop/Rpackage/NUWA/R/myfun.R', echo=TRUE)
source('D:/Users/xiergo/Desktop/Rpackage/NUWA/R/buildNetwork.R', echo=TRUE)
source('D:/Users/xiergo/Desktop/Rpackage/NUWA/R/myfun.R', echo=TRUE)
source('D:/Users/xiergo/Desktop/Rpackage/NUWA/R/buildNetwork.R', echo=TRUE)
source('D:/Users/xiergo/Desktop/Rpackage/NUWA/R/myfun.R', echo=TRUE)
source('D:/Users/xiergo/Desktop/Rpackage/NUWA/R/buildNetwork.R', echo=TRUE)
source('D:/Users/xiergo/Desktop/Rpackage/NUWA/R/myfun.R', echo=TRUE)
source('D:/Users/xiergo/Desktop/Rpackage/NUWA/R/buildNetwork.R', echo=TRUE)
str(res)
source('D:/Users/xiergo/Desktop/Rpackage/NUWA/R/recallAnalysis.R', encoding = 'UTF-8', echo=TRUE)
source('D:/Users/xiergo/Desktop/Rpackage/NUWA/R/recallAnalysis.R', encoding = 'UTF-8', echo=TRUE)
recallAnalysis <- function(x, corMethod = c("spearman", "pearson")[1]){
truth.pred=x$predVsTruth
pred=truth.pred[['pred']]
truth=truth.pred[['truth']]
geneIndex=1:nrow(truth)
names(geneIndex)=rownames(truth)
sampleIndex=1:ncol(truth)
names(sampleIndex)=colnames(truth)
rmHighCor <- T
if(rmHighCor){
truth.cor.gene <- sapply(geneIndex, function(x){
xx <- truth[x,]
res <- sapply(geneIndex, function(y){
if (x>=y) return(0) else{
yy <- truth[y,]
return(cor(xx,yy,use='p',method=corMethod))
}
})
})
truth.cor.gene <- truth.cor.gene + t(truth.cor.gene)
}
simNull.cor.gene=sapply(geneIndex, function(x){
xx=truth[x,]
res=sapply(geneIndex,function(y){
if(x==y) {
return(NA)
}else if (rmHighCor && !is.na(truth.cor.gene[x,y]) && truth.cor.gene[x,y]>0.5){
return(NA)
} else{
yy=pred[y,]
return(cor(xx,yy,use='p',method=corMethod))
}
})
})
simNull.cor.sample=sapply(sampleIndex, function(x){
xx=truth[,x]
res=sapply(sampleIndex,function(y){
if(x==y) return(NA) else{
yy=pred[,y]
return(cor(xx,yy,use='p',method=corMethod))
}
})
})
simNull.list=list(Gene=simNull.cor.gene,
Sample=simNull.cor.sample)
df.recall.ls=lapply(c('Gene','Sample'), function(level){
if(level == 'Sample'){
pred0=t(pred)
truth0=t(truth)
}else{
pred0=pred
truth0=truth
}
simNull=simNull.list[[level]]
simNull=as.vector(simNull)
simNull=simNull[!is.na(simNull)]
gs=rownames(pred0)
names(gs)=gs
dfls=lapply(gs,function(g){
x=pred0[g,]
y=truth0[g,]
cor=cor(x,y,use='p',method = corMethod)
pval=sum(simNull>cor)/length(simNull)
recall=1-pval
res=data.frame(g,cor,pval,recall,level)
names(res)=c('sample','cor','pval','recall','level')
return(res)
})
df=do.call(rbind,dfls)
return(df)
})
df.recall=do.call(rbind, df.recall.ls)
rownames(df.recall)=NULL
finalRes=list(
recallTable=df.recall,
simNull=simNull.list,
corMethod=corMethod
)
recallsum(df.recall)
return(finalRes)
}
load('../../gc.rda')
names(res)
a=recallAnalysis(res)
source('D:/Users/xiergo/Desktop/Rpackage/NUWA/R/recallAnalysis.R', encoding = 'UTF-8', echo=TRUE)
source('D:/Users/xiergo/Desktop/Rpackage/NUWA/R/recallAnalysis.R', echo=TRUE)
a=recallAnalysis(res)
b=factor(c("fdsag","fddgafgagfga"))
b
unique(b)
as.character(unique(b))
source('D:/Users/xiergo/Desktop/Rpackage/NUWA/R/myfun.R', echo=TRUE)
a=recallAnalysis(res)
devtools::document()
version
devtools::build_manual()
devtools::build_vignettes()
devtools::document()
devtools::build_manual()
devtools::document()
devtools::build_manual()
devtools::build_manual()
?recallAnalysis
devtools::build()
devtools::build_manual()
devtools::build_manual(pkg = "../NUWA/")
getwd()
?devtools::build_manual
setwd("../")
devtools::build_manual()
setwd("NUWA/")
devtools::document()
?NUWAeDeconv
devtools::document()
?NUWAeDeconv
?NUWAms
str(EPIC::BRef)
devtools::install_github('dviraran/xCell')
install.packages("glue")
install.packages("glue")
library(glue)
library(RCurl)
install.packages("RCurl")
remotes::install_github('dviraran/xCell')
library("xCell")
str(xCell::xCell.data)
names(xCell.data)
length(xCell.data$signatures)
length(xCell.data$signatures[1])
length(xCell.data$signatures[[1]])
a=unlist(xCell.data$signatures)
a[[1]]
b=a[[1]]
remotes::install_github("ebecht/MCPcounter")
install_github("ebecht/MCPcounter",ref="master", subdir="Source")
devtools::install_github("ebecht/MCPcounter",ref="master", subdir="Source")
genes=read.table(curl:::curl("https://raw.githubusercontent.com/ebecht/MCPcounter/master/Signatures/genes.txt"),sep="\t",stringsAsFactors=FALSE,header=TRUE,colClasses="character",check.names=FALSE)
genes=read.table(curl:::curl("https://raw.githubusercontent.com/ebecht/MCPcounter/master/Signatures/genes.txt"),sep="\t",stringsAsFactors=FALSE,header=TRUE,colClasses="character",check.names=FALSE)
head(genes)
mcpcounter_marker_list <- split(genes$`HUGO symbols`, genes$`Cell population`)
str(mcpcounter_marker_list)
save(mcpcounter_marker_list, file = "data/mcpcounter_marker_list.rda")
devtools::document()
unlist(xCell.data$signatures)
unlist(unlist(xCell.data$signatures))
a=lapply(unlist(xCell.data$signatures), function(x) x$geneIds)
a=lapply(unlist(xCell.data$signatures), function(x) x@geneIds)
a=lapply(xCell.data$signatures, function(x) x@geneIds)
str(a)[1:10]
load("data/mydata.rda")
LM22=lm22
LM6=lm6
BCIC=EPIC::BRef$refProfiles
mar=union(EPIC::BRef$sigGenes, EPIC::TRef$sigGenes)
BCIC=EPIC::BRef$refProfiles[mar,]
TIC=EPIC::TRef$refProfiles[mar,]
save(LM6,LM22,BCIC, TIC,files="data/signature_matrix.rda")
save(LM6,LM22,BCIC, TIC,files="data/signature_matrix.rda")
save(LM6,LM22,BCIC, TIC,file="data/signature_matrix.rda")
devtools::document()
devtools::document()
devtools::build()
devtools::build_manual()
?barplotCF
devtools::document()
?barplotCF
?boxplotCF
?buildNetwork
devtools::document()
devtools::build_manual()
?buildNetwork
?NUWA.cibersort
?NUWA.EPIC
?NUWA.EPIC
?NUWA.mcpcounter
?NUWA.xcel
?NUWA.xcell
?NUWA.eDeconv
?NUWAeDeconv
?NUWEms
?NUWAms
?recall.plot
?recall
devtools::document()
devtools::document()
devtools::build_vignettes()
devtools::build_manual()
tinytex::tlmgr_install("makeindex")
install.packages("tinytex")
install.packages("tinytex")
devtools::document()
devtools::build_manual()
tinytex::tlmgr_install("makeindex")
devtools::build_manual()
devtools::build()
devtools::build_manual()
devtools::document()
devtools::document()
devtools::build_manual()
devtools::build()
devtools::document()
devtools::document()
expr=read.delim("brca.txt")
rownames(expr)=expr[,1]
expr=data.matrix(expr)
res=NUWA.mcpcounter(expr[,1:3])
res=NUWA.mcpcounter(expr[,1:2])
devtools::document()
res=NUWA.mcpcounter(expr[,1:2])
?appendSignatures
prop <- MCPcounter::appendSignatures(expr[,1:3], markers = mcpcounter_marker_list)
prop
devtools::document()
res=NUWA.mcpcounter(expr[,1:2])
res_epic=NUWA.EPIC(expr[,1:2])
res_epic=NUWA.EPIC(expr[,1:2], signature_matrix = TIC)
length(rownames(TIC))
intersect(rownames(expr),rownames(TIC))
EPIC::TRef->a
str(a)
str(EPIC::BRef)
ref=list(refProfiles=TIC,sigGenes=rownames(TIC))
EPIC::EPIC(expr[,1:2],reference = ref)
NUWA.EPIC <- function(expr, signature_matrix) {
if (!is.matrix(expr)) {
stop("Parameter 'expr' should be a matrix")
}
if (!is.matrix(signature_matrix)) {
stop("Parameter 'signature_matrix' should be given as matrix.")
}
nw <- buildNetwork(markers = rownames(signature_matrix))
res <- NUWAms(expr, network = nw)
expr_impute <- res$finalExpr
print(str(expr))
print(str(expr_impute))
print(str(res))
predVsTruth <- res$predVsTruth
ref <- list(refProfiles = signature_matrix, sigGenes = rownames(signature_matrix))
prop <- EPIC::EPIC(expr_impute, ref)
return(list(proportion = prop, mixture_impute = expr_impute, predVsTruth = predVsTruth))
}
res_epic=NUWA.EPIC(expr[,1:2], signature_matrix = TIC)
dim(expr)
ex1=expr[,1:2]
sum(rowSums(is.na(ex1))==2)
sum(rowSums(is.na(ex1))==1)
sum(rowSums(is.na(ex1))==0)
devtools::document()
rm("NUWA.EPIC")
devtools::document()
res_epic=NUWA.EPIC(expr[,1:2], signature_matrix = TIC)
devtools::document()
res_epic=NUWA.EPIC(expr[,1:2], signature_matrix = TIC)
load("xie.rda")
dim(expr.final)
a=expr.final[!apply(is.na(expr.final),1,all),, drop = F]
dim(a)
sum(!apply(is.na(expr.final),1,all))
expr.final[apply(is.na(expr.final),1,all),][1:10,]
ex1[1:2,]
expr=expr[,-1]
head(expr[,1:2])
ex1=expr[,1:2]
table(rowSums(is.na(ex1)))
devtools::document()
res_epic=NUWA.EPIC(expr[,1:2], signature_matrix = TIC)
devtools::document()
res_ciber <- NUWA.cibersort(ex1)
res_ciber <- NUWA.cibersort(ex1, signature_matrix = LM6)
res_ciber <- NUWA.cibersort(ex1, signature_matrix = LM6, cibersortPath = 'xie.rda')
res_edeconv <- NUWAeDeconv(ex1, cibersortPath = 'xie.rda')
res_nuwaCiber <- NUWA.cibersort(
expr = ex1,
signature_matrix= LM22,
cibersortPath='xie.rda'
)
xcell.data
res_xcell <- NUWA.xcell(ex1)
devtools::document()
res_xcell <- NUWA.xcell(ex1)
prop <- xCell::xCellAnalysis(ex1, signatures = xCell::xCell.data$signatures,
genes = rownames(expr_impute))
prop <- xCell::xCellAnalysis(ex1, signatures = xCell::xCell.data$signatures,
genes = rownames(ex1))
prop <- xCell::xCellAnalysis(ex1, signatures = xCell::xCell.data$signatures,
genes = rownames(ex1))
a=xCell::xCell.data$signatures
prop <- xCell::xCellAnalysis(ex1, signatures = a,
genes = rownames(ex1))
devtools::document()
prop <- xCell::xCellAnalysis(ex1, signatures = a,
genes = rownames(ex1))
library(xCell)
prop <- xCell::xCellAnalysis(ex1, signatures = a,
genes = rownames(ex1))
prop
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::build_manual()
devtools::build()
xs <- seq(10,0,1)
?seq
xs <- seq(0, 1, length.out = 100)
theta <- 2
for (k in 0 : (theta - 1)) {
print(k)
}
e
exp(1)
cumprod(3)
cumprod(1:3)
3!
prod(3)
factorial(3)
plot(lambdas, p_sees, lty = 1)
source('~/.active-rstudio-document', echo=TRUE)
plot(lambdas, p_sees, lty = 1, type = 'l')
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
plot(c(0,300), c(0, 1), ann = 'n')
plot(c(0,300), c(0, 1), ann = 'n', type = 'n')
f=function(x) (x-min(x))/(max(x)-min(x))*99+1
f(c(2.1,99))
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
devtools::document()
devtools::build()
data = c(23.5,	0,
24.1,	0,
37.1,	0,
37.6,	4,
58.5,	12,
58.6,	18,
91,	54,
92.9,	44,
141.9,	94,
148.6,	94,
221.3,	100,
239.3,	100)
data
theta <- 1
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
data = c(23.5,	0,
24.1,	0,
37.1,	0,
37.6,	4,
58.5,	12,
58.6,	18,
91,	54,
92.9,	44,
141.9,	94,
148.6,	94,
221.3,	100,
239.3,	100)
source('~/.active-rstudio-document', echo=TRUE)
data = c(23.5,	0,
24.1,	0,
37.1,	0,
37.6,	4,
58.5,	12,
58.6,	18,
91,	54,
92.9,	44,
141.9,	94,
148.6,	94,
221.3,	100,
239.3,	100)
x <- data[1:12*2-1]
y <- data[1:12]
lambdas <- seq(0, 250, length.out = 1000)
alpha <- 0.1
plot(c(x, y, xlab = "lambda", ylab = "P_see")
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
setwd("../生物物理化学/")
ls
ls()
list.files()
dir.create("lesson1")
setwd("lesson1/")
sample(c(-1,1) 10)
sample(c(-1,1), 10)
sample(c(-1,1), 10, replace = R)
sample(c(-1,1), 10, replace = T)
source('D:/Users/xiergo/Desktop/NUWA/R/6randomwalk_a.R', echo=TRUE)
source('D:/Users/xiergo/Desktop/NUWA/R/6randomwalk_a.R', echo=TRUE)
source('D:/Users/xiergo/Desktop/NUWA/R/6randomwalk_a.R', echo=TRUE)
source('D:/Users/xiergo/Desktop/NUWA/R/6randomwalk_a.R', echo=TRUE)
par('usr')
source('D:/Users/xiergo/Desktop/NUWA/R/6randomwalk_a.R', echo=TRUE)
?text
source('D:/Users/xiergo/Desktop/NUWA/R/6randomwalk_a.R', echo=TRUE)
source('D:/Users/xiergo/Desktop/NUWA/R/6randomwalk_a.R', echo=TRUE)
source('D:/Users/xiergo/Desktop/NUWA/R/6randomwalk_a.R', echo=TRUE)
source('D:/Users/xiergo/Desktop/NUWA/R/6randomwalk_a.R', echo=TRUE)
?sample
source('D:/Users/xiergo/Desktop/NUWA/R/6randomwalk_a.R', echo=TRUE)
source('D:/Users/xiergo/Desktop/NUWA/R/6randomwalk_a.R', echo=TRUE)
source('D:/Users/xiergo/Desktop/NUWA/R/6randomwalk_a.R', echo=TRUE)
devtools::build()
devtools::document()
devtools::build()
?kruskal.test
dim(matrix(1:12,3))
library(ggplot2)
ggplot(1)+geom_point()
ggplot(data.frame(x=1:3,y=1:3))+geom_point()
ggplot(data.frame(x=1:3,y=1:3),mapping = aes(x,y))+geom_point()
ggplot(data.frame(x=1:3,y=1:3),mapping = aes(x,y))+geom_point()+labs(xlab=expression(paste("self cor", rho)))
ggplot(data.frame(x=1:3,y=1:3),mapping = aes(x,y))+geom_point()+labs(xlab=expression(paste("self cor", rho)))
ggplot(data.frame(x=1:3,y=1:3),mapping = aes(x,y))+geom_point()+labs(x=expression(paste("self cor", rho)))
ggplot(data.frame(x=1:3,y=1:3),mapping = aes(x,y))+geom_point()+labs(x=expression(paste("self cor ", rho)))
a='gdsaf'
ggplot(data.frame(x=1:3,y=1:3),mapping = aes(x,y))+geom_point()+labs(x=expression(paste(a, rho)))
devtools::document()
devtools::build()
devtools::build_manual()
?barplot
?barplotCF
devtools::document()
devtools::build_manual()
devtools::build()
devtools::document()
devtools::build()
1477%%365
1530%%365
devtools::document()
check_cibersort
NUWA::check_cibersort
devtools::build()
setwd('../..')
install.packages('Desktop/NUWA_0.1.0.tar.gz')
install.packages('Desktop/NUWA_0.1.0.tar.gz',repos = NULL, type="source")
source('Desktop/check_cibersort.R')
devtools::document()
install.packages('Desktop/NUWA_0.1.0.tar.gz',repos = NULL, type="source")
rm(list = ls())
NUWA::check_cibersort
